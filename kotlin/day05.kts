val dependencies: List<Pair<Int, Int>> = listOf(58 to 55, 89 to 38, 89 to 34, 85 to 64, 85 to 25, 85 to 43, 71 to 97, 71 to 17, 71 to 85, 71 to 87, 91 to 77, 91 to 67, 91 to 35, 91 to 85, 91 to 44, 49 to 43, 49 to 27, 49 to 38, 49 to 75, 49 to 34, 49 to 55, 78 to 13, 78 to 62, 78 to 23, 78 to 43, 78 to 51, 78 to 49, 78 to 83, 77 to 49, 77 to 17, 77 to 85, 77 to 46, 77 to 71, 77 to 97, 77 to 19, 77 to 87, 51 to 75, 51 to 15, 51 to 47, 51 to 79, 51 to 67, 51 to 34, 51 to 24, 51 to 83, 51 to 84, 36 to 38, 36 to 94, 36 to 89, 36 to 64, 36 to 62, 36 to 45, 36 to 44, 36 to 87, 36 to 78, 36 to 39, 76 to 51, 76 to 39, 76 to 55, 76 to 64, 76 to 17, 76 to 25, 76 to 62, 76 to 49, 76 to 43, 76 to 27, 76 to 78, 48 to 77, 48 to 19, 48 to 97, 48 to 86, 48 to 53, 48 to 85, 48 to 71, 48 to 74, 48 to 15, 48 to 91, 48 to 59, 48 to 34, 46 to 78, 46 to 64, 46 to 76, 46 to 44, 46 to 43, 46 to 24, 46 to 85, 46 to 27, 46 to 17, 46 to 19, 46 to 49, 46 to 35, 46 to 36, 34 to 79, 34 to 59, 34 to 53, 34 to 46, 34 to 86, 34 to 97, 34 to 75, 34 to 36, 34 to 57, 34 to 83, 34 to 98, 34 to 71, 34 to 45, 34 to 74, 11 to 15, 11 to 91, 11 to 46, 11 to 74, 11 to 84, 11 to 48, 11 to 79, 11 to 77, 11 to 34, 11 to 24, 11 to 53, 11 to 67, 11 to 19, 11 to 36, 11 to 57, 53 to 98, 53 to 79, 53 to 35, 53 to 46, 53 to 57, 53 to 91, 53 to 85, 53 to 97, 53 to 36, 53 to 84, 53 to 67, 53 to 59, 53 to 93, 53 to 15, 53 to 44, 53 to 45, 47 to 24, 47 to 71, 47 to 13, 47 to 19, 47 to 91, 47 to 46, 47 to 98, 47 to 74, 47 to 53, 47 to 75, 47 to 67, 47 to 57, 47 to 45, 47 to 77, 47 to 83, 47 to 79, 47 to 36, 55 to 79, 55 to 91, 55 to 57, 55 to 19, 55 to 53, 55 to 24, 55 to 36, 55 to 13, 55 to 67, 55 to 74, 55 to 98, 55 to 86, 55 to 45, 55 to 15, 55 to 85, 55 to 75, 55 to 46, 55 to 59, 35 to 23, 35 to 11, 35 to 94, 35 to 47, 35 to 64, 35 to 62, 35 to 27, 35 to 49, 35 to 72, 35 to 38, 35 to 83, 35 to 87, 35 to 25, 35 to 43, 35 to 44, 35 to 39, 35 to 51, 35 to 48, 35 to 74, 45 to 89, 45 to 85, 45 to 51, 45 to 49, 45 to 97, 45 to 64, 45 to 25, 45 to 93, 45 to 58, 45 to 23, 45 to 78, 45 to 87, 45 to 44, 45 to 94, 45 to 27, 45 to 39, 45 to 11, 45 to 62, 45 to 38, 45 to 72, 38 to 55, 38 to 59, 38 to 83, 38 to 51, 38 to 67, 38 to 94, 38 to 91, 38 to 58, 38 to 48, 38 to 47, 38 to 77, 38 to 75, 38 to 13, 38 to 62, 38 to 15, 38 to 86, 38 to 72, 38 to 74, 38 to 23, 38 to 53, 38 to 25, 64 to 25, 64 to 94, 64 to 62, 64 to 34, 64 to 11, 64 to 53, 64 to 59, 64 to 58, 64 to 38, 64 to 74, 64 to 75, 64 to 51, 64 to 48, 64 to 13, 64 to 86, 64 to 55, 64 to 47, 64 to 43, 64 to 49, 64 to 27, 64 to 83, 64 to 23, 62 to 48, 62 to 77, 62 to 83, 62 to 55, 62 to 25, 62 to 34, 62 to 86, 62 to 15, 62 to 84, 62 to 53, 62 to 79, 62 to 47, 62 to 59, 62 to 67, 62 to 74, 62 to 72, 62 to 94, 62 to 75, 62 to 11, 62 to 91, 62 to 13, 62 to 57, 62 to 58, 44 to 27, 44 to 43, 44 to 74, 44 to 49, 44 to 86, 44 to 11, 44 to 38, 44 to 64, 44 to 89, 44 to 94, 44 to 72, 44 to 47, 44 to 39, 44 to 25, 44 to 55, 44 to 34, 44 to 87, 44 to 23, 44 to 83, 44 to 78, 44 to 51, 44 to 62, 44 to 48, 44 to 58, 72 to 67, 72 to 53, 72 to 77, 72 to 46, 72 to 75, 72 to 71, 72 to 11, 72 to 84, 72 to 15, 72 to 55, 72 to 34, 72 to 91, 72 to 25, 72 to 24, 72 to 79, 72 to 57, 72 to 36, 72 to 48, 72 to 13, 72 to 59, 72 to 83, 72 to 86, 72 to 74, 72 to 47, 15 to 45, 15 to 27, 15 to 76, 15 to 89, 15 to 77, 15 to 19, 15 to 35, 15 to 87, 15 to 79, 15 to 24, 15 to 64, 15 to 98, 15 to 46, 15 to 97, 15 to 17, 15 to 93, 15 to 39, 15 to 36, 15 to 71, 15 to 78, 15 to 85, 15 to 49, 15 to 44, 15 to 57, 94 to 51, 94 to 74, 94 to 13, 94 to 58, 94 to 83, 94 to 79, 94 to 59, 94 to 25, 94 to 46, 94 to 53, 94 to 67, 94 to 72, 94 to 48, 94 to 34, 94 to 75, 94 to 84, 94 to 55, 94 to 77, 94 to 15, 94 to 47, 94 to 86, 94 to 91, 94 to 57, 94 to 11, 84 to 35, 84 to 77, 84 to 98, 84 to 93, 84 to 85, 84 to 45, 84 to 87, 84 to 79, 84 to 64, 84 to 44, 84 to 36, 84 to 97, 84 to 78, 84 to 46, 84 to 76, 84 to 89, 84 to 24, 84 to 39, 84 to 57, 84 to 49, 84 to 17, 84 to 15, 84 to 19, 84 to 71, 98 to 62, 98 to 94, 98 to 64, 98 to 89, 98 to 44, 98 to 43, 98 to 27, 98 to 87, 98 to 97, 98 to 19, 98 to 45, 98 to 17, 98 to 85, 98 to 39, 98 to 72, 98 to 93, 98 to 51, 98 to 76, 98 to 23, 98 to 35, 98 to 58, 98 to 49, 98 to 38, 98 to 78, 79 to 64, 79 to 27, 79 to 17, 79 to 76, 79 to 78, 79 to 36, 79 to 49, 79 to 45, 79 to 71, 79 to 97, 79 to 39, 79 to 85, 79 to 43, 79 to 24, 79 to 44, 79 to 98, 79 to 93, 79 to 89, 79 to 38, 79 to 87, 79 to 46, 79 to 57, 79 to 35, 79 to 19, 17 to 35, 17 to 87, 17 to 94, 17 to 25, 17 to 58, 17 to 43, 17 to 49, 17 to 78, 17 to 38, 17 to 55, 17 to 27, 17 to 72, 17 to 11, 17 to 51, 17 to 34, 17 to 44, 17 to 23, 17 to 64, 17 to 47, 17 to 62, 17 to 83, 17 to 39, 17 to 48, 17 to 89, 59 to 87, 59 to 35, 59 to 24, 59 to 67, 59 to 19, 59 to 36, 59 to 39, 59 to 93, 59 to 84, 59 to 57, 59 to 77, 59 to 85, 59 to 79, 59 to 98, 59 to 75, 59 to 44, 59 to 45, 59 to 89, 59 to 46, 59 to 97, 59 to 17, 59 to 76, 59 to 71, 59 to 15, 87 to 64, 87 to 72, 87 to 48, 87 to 13, 87 to 62, 87 to 34, 87 to 55, 87 to 38, 87 to 94, 87 to 83, 87 to 11, 87 to 47, 87 to 43, 87 to 58, 87 to 23, 87 to 78, 87 to 49, 87 to 51, 87 to 74, 87 to 86, 87 to 27, 87 to 25, 87 to 39, 87 to 89, 93 to 43, 93 to 94, 93 to 78, 93 to 39, 93 to 23, 93 to 87, 93 to 38, 93 to 49, 93 to 76, 93 to 47, 93 to 25, 93 to 51, 93 to 35, 93 to 17, 93 to 89, 93 to 64, 93 to 48, 93 to 72, 93 to 44, 93 to 62, 93 to 11, 93 to 27, 93 to 58, 93 to 55, 13 to 46, 13 to 77, 13 to 75, 13 to 45, 13 to 15, 13 to 24, 13 to 53, 13 to 98, 13 to 84, 13 to 36, 13 to 17, 13 to 19, 13 to 91, 13 to 79, 13 to 67, 13 to 76, 13 to 59, 13 to 57, 13 to 97, 13 to 35, 13 to 71, 13 to 93, 13 to 85, 13 to 44, 23 to 47, 23 to 15, 23 to 74, 23 to 25, 23 to 58, 23 to 77, 23 to 86, 23 to 79, 23 to 91, 23 to 72, 23 to 55, 23 to 83, 23 to 48, 23 to 84, 23 to 94, 23 to 67, 23 to 51, 23 to 34, 23 to 53, 23 to 13, 23 to 62, 23 to 11, 23 to 75, 23 to 59, 27 to 38, 27 to 34, 27 to 91, 27 to 23, 27 to 75, 27 to 84, 27 to 62, 27 to 13, 27 to 58, 27 to 11, 27 to 51, 27 to 86, 27 to 74, 27 to 47, 27 to 94, 27 to 67, 27 to 83, 27 to 48, 27 to 25, 27 to 53, 27 to 43, 27 to 55, 27 to 72, 27 to 59, 24 to 71, 24 to 44, 24 to 94, 24 to 45, 24 to 17, 24 to 78, 24 to 36, 24 to 93, 24 to 87, 24 to 23, 24 to 85, 24 to 19, 24 to 62, 24 to 38, 24 to 35, 24 to 64, 24 to 89, 24 to 97, 24 to 39, 24 to 43, 24 to 49, 24 to 27, 24 to 98, 24 to 76, 19 to 45, 19 to 64, 19 to 27, 19 to 89, 19 to 76, 19 to 51, 19 to 97, 19 to 49, 19 to 58, 19 to 93, 19 to 17, 19 to 23, 19 to 62, 19 to 94, 19 to 38, 19 to 35, 19 to 87, 19 to 78, 19 to 85, 19 to 25, 19 to 72, 19 to 39, 19 to 43, 19 to 44, 97 to 44, 97 to 35, 97 to 47, 97 to 55, 97 to 49, 97 to 78, 97 to 23, 97 to 27, 97 to 62, 97 to 93, 97 to 89, 97 to 11, 97 to 72, 97 to 51, 97 to 94, 97 to 17, 97 to 25, 97 to 38, 97 to 58, 97 to 87, 97 to 76, 97 to 64, 97 to 43, 97 to 39, 67 to 97, 67 to 17, 67 to 77, 67 to 39, 67 to 89, 67 to 71, 67 to 93, 67 to 84, 67 to 98, 67 to 45, 67 to 76, 67 to 24, 67 to 15, 67 to 79, 67 to 44, 67 to 19, 67 to 78, 67 to 64, 67 to 35, 67 to 57, 67 to 87, 67 to 85, 67 to 36, 67 to 46, 43 to 84, 43 to 59, 43 to 25, 43 to 11, 43 to 48, 43 to 13, 43 to 91, 43 to 38, 43 to 53, 43 to 94, 43 to 86, 43 to 15, 43 to 58, 43 to 72, 43 to 47, 43 to 34, 43 to 83, 43 to 67, 43 to 62, 43 to 74, 43 to 55, 43 to 75, 43 to 51, 43 to 23, 74 to 17, 74 to 71, 74 to 84, 74 to 79, 74 to 53, 74 to 93, 74 to 19, 74 to 97, 74 to 13, 74 to 36, 74 to 59, 74 to 86, 74 to 75, 74 to 67, 74 to 98, 74 to 85, 74 to 15, 74 to 91, 74 to 46, 74 to 76, 74 to 45, 74 to 77, 74 to 57, 74 to 24, 57 to 87, 57 to 64, 57 to 39, 57 to 24, 57 to 71, 57 to 17, 57 to 97, 57 to 93, 57 to 36, 57 to 27, 57 to 23, 57 to 78, 57 to 45, 57 to 76, 57 to 35, 57 to 98, 57 to 46, 57 to 38, 57 to 43, 57 to 19, 57 to 89, 57 to 85, 57 to 44, 57 to 49, 83 to 85, 83 to 13, 83 to 15, 83 to 36, 83 to 74, 83 to 86, 83 to 71, 83 to 59, 83 to 46, 83 to 91, 83 to 19, 83 to 79, 83 to 53, 83 to 97, 83 to 57, 83 to 93, 83 to 77, 83 to 76, 83 to 67, 83 to 45, 83 to 98, 83 to 24, 83 to 75, 83 to 84, 39 to 91, 39 to 48, 39 to 34, 39 to 51, 39 to 55, 39 to 23, 39 to 47, 39 to 27, 39 to 83, 39 to 64, 39 to 74, 39 to 86, 39 to 53, 39 to 43, 39 to 13, 39 to 78, 39 to 94, 39 to 49, 39 to 25, 39 to 58, 39 to 72, 39 to 62, 39 to 11, 39 to 38, 25 to 55, 25 to 46, 25 to 57, 25 to 71, 25 to 79, 25 to 75, 25 to 67, 25 to 74, 25 to 11, 25 to 48, 25 to 86, 25 to 15, 25 to 91, 25 to 53, 25 to 24, 25 to 98, 25 to 84, 25 to 34, 25 to 13, 25 to 59, 25 to 83, 25 to 36, 25 to 47, 25 to 77, 75 to 76, 75 to 71, 75 to 39, 75 to 89, 75 to 67, 75 to 57, 75 to 15, 75 to 17, 75 to 24, 75 to 19, 75 to 97, 75 to 84, 75 to 77, 75 to 78, 75 to 44, 75 to 45, 75 to 93, 75 to 79, 75 to 36, 75 to 35, 75 to 85, 75 to 46, 75 to 98, 75 to 87, 86 to 71, 86 to 19, 86 to 84, 86 to 57, 86 to 97, 86 to 67, 86 to 17, 86 to 93, 86 to 59, 86 to 91, 86 to 98, 86 to 79, 86 to 76, 86 to 77, 86 to 53, 86 to 45, 86 to 35, 86 to 75, 86 to 85, 86 to 15, 86 to 13, 86 to 36, 86 to 24, 86 to 46, 58 to 46, 58 to 36, 58 to 83, 58 to 59, 58 to 34, 58 to 72, 58 to 24, 58 to 57, 58 to 11, 58 to 13, 58 to 25, 58 to 91, 58 to 77, 58 to 86, 58 to 53, 58 to 67, 58 to 79, 58 to 15, 58 to 47, 58 to 75, 58 to 84, 58 to 48, 58 to 74, 89 to 47, 89 to 72, 89 to 49, 89 to 25, 89 to 62, 89 to 27, 89 to 43, 89 to 86, 89 to 39, 89 to 53, 89 to 78, 89 to 51, 89 to 83, 89 to 58, 89 to 64, 89 to 55, 89 to 48, 89 to 13, 89 to 23, 89 to 74, 89 to 94, 89 to 11, 85 to 23, 85 to 47, 85 to 62, 85 to 94, 85 to 49, 85 to 44, 85 to 78, 85 to 58, 85 to 87, 85 to 76, 85 to 38, 85 to 17, 85 to 97, 85 to 93, 85 to 51, 85 to 35, 85 to 27, 85 to 89, 85 to 11, 85 to 72, 85 to 39, 71 to 38, 71 to 43, 71 to 78, 71 to 94, 71 to 19, 71 to 27, 71 to 93, 71 to 49, 71 to 76, 71 to 35, 71 to 23, 71 to 44, 71 to 51, 71 to 62, 71 to 39, 71 to 89, 71 to 45, 71 to 98, 71 to 64, 71 to 58, 91 to 15, 91 to 45, 91 to 84, 91 to 75, 91 to 46, 91 to 93, 91 to 87, 91 to 59, 91 to 89, 91 to 76, 91 to 97, 91 to 71, 91 to 98, 91 to 24, 91 to 79, 91 to 57, 91 to 17, 91 to 19, 91 to 36, 49 to 51, 49 to 59, 49 to 23, 49 to 91, 49 to 72, 49 to 47, 49 to 13, 49 to 58, 49 to 48, 49 to 11, 49 to 94, 49 to 86, 49 to 62, 49 to 25, 49 to 74, 49 to 53, 49 to 83, 49 to 67, 78 to 72, 78 to 27, 78 to 53, 78 to 74, 78 to 58, 78 to 34, 78 to 86, 78 to 11, 78 to 91, 78 to 48, 78 to 25, 78 to 38, 78 to 47, 78 to 64, 78 to 55, 78 to 94, 78 to 59, 77 to 98, 77 to 36, 77 to 93, 77 to 35, 77 to 76, 77 to 78, 77 to 44, 77 to 79, 77 to 64, 77 to 43, 77 to 45, 77 to 39, 77 to 57, 77 to 24, 77 to 27, 77 to 89, 51 to 57, 51 to 11, 51 to 25, 51 to 86, 51 to 91, 51 to 46, 51 to 58, 51 to 13, 51 to 48, 51 to 55, 51 to 77, 51 to 74, 51 to 59, 51 to 72, 51 to 53, 36 to 23, 36 to 43, 36 to 35, 36 to 19, 36 to 49, 36 to 27, 36 to 97, 36 to 17, 36 to 51, 36 to 93, 36 to 71, 36 to 85, 36 to 76, 36 to 98, 76 to 34, 76 to 58, 76 to 44, 76 to 38, 76 to 48, 76 to 35, 76 to 87, 76 to 89, 76 to 72, 76 to 23, 76 to 47, 76 to 94, 76 to 11, 48 to 45, 48 to 24, 48 to 98, 48 to 57, 48 to 84, 48 to 36, 48 to 13, 48 to 67, 48 to 75, 48 to 83, 48 to 46, 48 to 79, 46 to 39, 46 to 89, 46 to 23, 46 to 38, 46 to 93, 46 to 97, 46 to 45, 46 to 87, 46 to 71, 46 to 98, 46 to 62, 34 to 84, 34 to 24, 34 to 91, 34 to 67, 34 to 19, 34 to 15, 34 to 77, 34 to 93, 34 to 85, 34 to 13, 11 to 75, 11 to 47, 11 to 86, 11 to 83, 11 to 98, 11 to 13, 11 to 55, 11 to 59, 11 to 71, 53 to 19, 53 to 17, 53 to 76, 53 to 77, 53 to 24, 53 to 75, 53 to 87, 53 to 71, 47 to 15, 47 to 34, 47 to 48, 47 to 86, 47 to 55, 47 to 59, 47 to 84, 55 to 77, 55 to 48, 55 to 34, 55 to 84, 55 to 83, 55 to 71, 35 to 89, 35 to 78, 35 to 34, 35 to 58, 35 to 55, 45 to 35, 45 to 17, 45 to 76, 45 to 43, 38 to 11, 38 to 34, 38 to 84, 64 to 91, 64 to 72, 62 to 51)
val updates: List<List<Int>> = listOf("98,85,15,24,46,97,19,89,87,44,57", "64,39,94,19,49,27,85,36,23", "17,71,97,93,49,43,24,76,62,98,27,87,38,19,44,89,78", "13,71,57,79,76,24,36,67,77,74,19", "79,71,45,17,87,49,43", "53,91,75,84,15,79,46,24,36,71,98,19,85,97,93,35,44", "49,43,38,11,48,83,86,13,53,91,75", "62,94,51,72,47,48,74,86,13,53,59,75,67,15,77", "97,38,62,39,45,36,49,23,35,43,78,89,94,27,71,44,19,93,85", "94,51,83,47,91,13,67,72,86,11,59,25,84,79,57,74,34,77,48,58,15,55,53", "34,91,49,23,43,13,53,74,86,78,55,62,94", "97,17,35,87,39,78,64,49,38,51,25", "17,35,87,89,78,64,43,38,62,94,51,72,11,55,34", "45,71,93,64,35,39,89,76,98,44,24,27,49,17,78,46,38,85,97,43,23", "23,35,27,72,89,47,38,43,44", "77,57,46,36,98,19,85,97,35,44,39,64,27", "34,83,47,84,11,59,53,67,48,86,38,91,23,62,94,15,13,58,75,72,55,51,74", "79,98,44,78,87,97,24,15,17,71,36,77,67,89,46", "87,39,49,43,94,58,72,11,47,48,86", "15,86,83,58,72,25,91,84,53,51,55,47,62,13,23,38,11,59,94,48,74", "53,74,98,57,86,46,13,19,59,48,75,85,83,34,71", "72,86,62,51,38,15,84,58,91", "87,39,79,57,71,97,19,89,44,35,67,77,24,46,78,36,84", "25,34,74,91,67,84,77,36,71", "35,87,39,62,94,51,72,34,83", "76,17,35,44,87,78,64,49,27,43,38,23,62,94,51,58,25,55,48", "75,45,67,93,39,71,15", "46,24,36,98,19,97,76,87,49,38,23", "87,94,44,89,98,71,38,17,35,78,36", "76,17,35,44,87,89,23,51,72,11,47", "43,35,46,45,19,97,24,36,89,79,93", "53,83,79,84,47,59,77,55,67,48,25,15,72,74,91,36,86", "27,87,78,44,64,98,71,77,57,35,85,39,93,19,89,46,17,76,97,79,45,24,49", "79,57,46,71,98,19,45,85,97,93,76,17,44,87,89,39,78,64,49,27,43", "44,64,49,27,23,62,94,51,58,25,11,83,74", "79,46,24,36,71,98,19,45,85,97,93,17,35,89,39,78,64,49,43", "79,46,87,45,97,44,27,39,43,19,64", "25,11,47,48,34,83,74,86,13,53,59,75,67,15,77,79,24,36,71", "13,53,79,19,45,76,35", "53,91,59,75,67,84,15,77,79,57,46,24,36,71,98,19,85,97,93,76,17,35,44", "49,48,39,51,38,27,87,55,83,23,64,62,44,78,72,94,58,43,47,34,35", "93,76,44,89,39,78,49,38,23,25,11,47,55", "98,45,97,93,76,87,89,78,23,62,94,51,58", "74,36,72,79,24,48,53,59,55", "38,51,17,94,11,49,93", "58,47,55,48,83,86,59,75,67,84,77,79,57,46,24", "71,78,97,49,76,23,94,64,45,89,93,62,51,98,17,38,39,19,85,27,43", "38,58,94,49,83,53,25,62,75,23,27", "53,91,84,15,77,79,46,24,36,98,85,97,93,76,17,35,44", "25,86,47,27,59,48,83,58,94,55,43,62,75,51,67,91,13,53,11", "19,45,85,97,93,76,17,35,44,87,89,78,64,49,27,43,38,23,62,94,51,58,72", "55,84,86,72,58,11,91,46,57,34,24,83,77", "87,39,78,49,62,94,72,74,86", "85,97,93,76,17,35,44,87,78,64,49,27,43,38,23,62,94,51,58,72,25", "36,34,67,91,59,57,77,53,97", "84,15,77,57,46,24,45,85,97,93,76,35,44,87,39,78,64", "51,62,58,97,43,85,64,87,89,44,93,27,94,25,11", "84,15,57,24,36,71,98,19,45,85,97,93,76,17,44,87,89,78,64", "36,62,76,44,38,24,93", "67,48,24,86,11,91,53,13,34,84,55", "25,74,53,84,46,15,11,55,34,71,48,75,77,47,59,24,57,83,36", "49,79,57,78,77,27,36", "24,36,98,45,85,97,93,76,35,44,87,89,78", "77,57,79,15,78,49,19", "93,78,97,85,19,44,49,27,62,24,89,23,17,43,64,36,87,45,76", "62,94,51,58,72,25,11,55,48,34,83,74,86,13,53,91,59,75,67,84,15,77,79", "34,53,72,51,83,11,86,48,67,47,77,13,59,57,75,58,46", "67,36,74,77,24,34,19,53,98,86,46,45,83,71,91,15,57,75,13,84,48,59,55", "36,93,17,44,87,89,27", "93,57,77,39,79,44,89,75,46,45,97,35,15,76,87,84,71,98,17", "62,47,79,25,51,72,74,55,94,84,53", "45,93,17,35,44,87,89,39,78,49,27,62,51,58,25", "57,64,84,24,87,46,36,76,39,85,78", "86,25,79,15,46,57,58,77,13,47,91,84,75,51,59,55,74", "89,64,58,94,43,87,44,47,93,49,51,76,11,78,17,72,97,38,25,27,39,62,23", "72,25,11,47,55,34,83,74,13,53,91,59,67,84,15,77,79,57,46,24,36", "53,75,24,71,46,86,67,45,98,84,83,91,57,36,55,19,79,77,59,48,34", "89,97,85,98,44,58,51", "86,53,91,59,75,67,15,77,79,57,46,98,85,97,93,76,17", "64,38,23,94,51,58,72,25,11,55,48,34,83,74,86,13,53,91,59", "64,38,47,34,72,94,17,25,49,58,55", "35,36,39,49,78,27,57,89,46,76,93,17,98,44,77", "64,49,39,34,51,48,62,43,78,35,58,87,25,89,27,38,11,55,44,94,83", "62,51,11,83,74,13,79", "11,27,62,67,13,83,23,72,38,58,53", "27,23,62,58,47,13,67", "93,17,35,87,39,64,49,27,43,62,94,58,25,11,47", "15,57,46,19,76,17,35,44,87,89,64", "39,74,13,38,86,11,78,53,43", "87,78,94,64,62,85,39,72,23", "85,93,78,64,43,62,94,72,11", "15,58,79,83,13,91,57,53,48", "57,24,71,19,45,97,93,76,35,44,89,64,49,43,38", "51,34,43,75,27,94,25,83,55,13,38,91,62,48,59,47,11,86,58,53,67", "71,98,19,45,85,97,93,76,17,35,44,87,89,39,78,64,49,27,38,94,51", "36,71,98,19,85,97,93,76,17,35,44,87,89,39,78,64,49,27,43,38,23,62,94", "36,71,98,19,45,97,93,44,43,38,23,62,94", "13,34,84,46,67,83,91,86,47,55,11", "67,84,75,15,46,74,48,34,11,83,71,53,36,77,86,91,57,79,98,24,13", "76,87,35,98,39,71,27,85,93,78,49,24,62,38,44,45,43,17,19,23,64", "67,25,48,13,71,36,79,77,59,53,83,11,86", "59,71,75,74,13,91,79,67,47,86,57,48,53,19,98,55,77,46,15,83,84", "48,83,86,13,84,15,79,46,36,71,98", "47,55,78,11,64,48,17,44,58,62,72,51,23,38,25,35,89,76,94,39,43,87,49", "34,83,74,86,13,53,91,59,75,67,84,15,77,79,57,46,24,36,71,19,45,85,97", "13,53,91,59,75,67,84,15,77,79,57,24,36,71,19,45,85,97,93,76,35", "17,35,44,87,89,78,64,27,43,38,23,62,51,72,25,11,47,48,34", "43,38,23,62,94,51,72,25,47,55,48,34,74,86,53,59,75,67,84", "19,76,17,35,44,87,89,39,64,49,27,23,62,58,72", "17,35,44,87,89,39,78,64,49,27,43,38,23,62,94,51,58,72,11,47,55,48,34", "86,13,67,46,75,84,83,58,91,72,11,74,77,47,55,53,15,48,25,34,59,57,24", "59,15,57,98,44,87,89", "71,76,67,36,57,79,24,91,15,98,86,59,46,77,45,97,85,53,17,19,75,84,13", "62,51,58,72,25,55,48,34,83,74,53", "77,15,49,87,46,71,24", "86,13,91,59,75,67,15,57,36,71,19,45,85,97,93,76,17", "55,48,34,53,67,84,79,98,45", "47,27,94,67,75,43,11", "85,36,27,49,94,19,43,38,93,45,89,97,71,76,44,23,64,98,87,78,62", "78,25,38,86,94,27,58,11,49,83,87,43,72,23,64,39,74,55,34,89,47,51,48", "57,24,71,19,85,97,76,17,35,87,89,78,64,49,27", "93,71,79,19,97,77,44,15,87,35,67,84,91,85,76", "64,43,94,86,49,83,53,72,23,55,58,13,27,91,74,34,62,38,48,11,78", "62,13,53,91,59,77,79", "39,78,64,27,43,38,62,94,72,25,11,47,48,34,83,74,86,13,53", "83,46,93,97,71,98,59,53,36,13,84", "79,57,55,34,15,47,74,25,11,53,58,67,86,46,91,84,13,48,75", "36,35,98,49,79,45,24,44,78,97,71,64,93,17,87,77,46", "44,89,78,64,94,72,48", "86,72,43,11,78", "19,17,98,62,39,24,43,71,49,38,64,97,36,35,93", "62,94,51,58,72,25,11,47,55,48,34,74,86,53,91,59,75,67,84,77,79", "34,79,62,72,77,25,75", "91,75,84,77,79,57,46,36,71,19,17,44,87", "36,85,75,97,19,76,13,15,84,77,24,86,45,91,53,67,59,17,71", "64,27,62,94,58,11,55,48,74,53,59", "55,48,34,83,74,13,53,91,59,24,36,71,98,19,45", "11,47,58,23,17,51,64,72,76,55,35,89,78,49,43,94,44", "62,94,58,25,47,48,83,86,13,15,77", "93,35,43,51,38,87,89,17,39,78,94,45,98,71,76,85,62", "57,46,24,36,71,98,19,85,93,76,17,44,87,89,39,78,49,27,38", "84,77,46,24,98,85,17,87,64", "83,74,13,53,59,75,67,15,79,57,46,98,45,85,97", "39,17,62,51,35,45,76,43,64,44,94,93,98,58,19,87,78", "48,74,86,13,53,91,59,67,84,15,77,79,57,46,24,36,71,98,19,45,85", "19,45,97,93,76,17,44,87,89,39,49,43,38,62,94,58,72", "23,17,46,38,24,49,87", "75,77,57,46,36,71,45,97,76,17,35,44,87,89,39", "34,83,74,86,53,91,59,75,67,84,15,77,57,46,36,71,98,19,45,85,97", "89,78,55,83,72,58,11,64,13,94,38,47,62,74,34,86,49,23,51,25,27", "53,94,79,55,57,83,58,74,77,47,25,67,13", "71,75,85,97,15,35,13,84,93", "89,93,39,11,62,58,78,97,25,27,51,94,76,72,49,35,44,64,87,47,43,23,38", "57,77,71,87,97,24,91,59,85,35,44,15,17", "24,35,97,76,19,45,93,79,46", "58,72,25,47,55,34,83,74,13,53,91,67,84,15,57,46,24", "46,24,36,71,98,19,45,85,93,76,17,35,89,39,78,64,49,27,43,38,23", "27,43,38,23,62,51,58,72,25,11,47,55,48,34,83,74,86,13,53,91,75", "23,51,72,34,83,74,13,53,84,15,77", "67,83,57,36,93,46,77,15,91,97,59,71,74,84,19", "23,49,27,64,51,86,72,39,58,87,38", "34,74,86,59,84,77,79,24,36,71,98,19,45", "91,75,67,15,77,79,46,24,36,71,98,19,85,97,76,17,35,44,87", "89,51,47,83,11,38,64,72,78,49,39,74,48,94,27,87,44,34,25,55,43,23,62", "77,98,86,19,93,15,13", "38,23,94,58,48,34,13,91,75,67,15", "71,98,45,97,93,76,17,35,89,39,78,49,43,38,23,62,51", "48,74,86,13,53,59,15,79,46,24,36,19,45", "55,58,23,47,43,48,49,13,86,38,51,78,72,94,11,34,74,62,64,83,53", "43,38,62,94,51,58,72,25,11,55,34,74,86,13,53,91,59,67,84", "51,57,74,72,55,47,86,34,91,77,83,79,59,58,11", "74,47,53,51,15,75,59,46,55", "15,57,24,36,98,19,85,97,93,76,17,35,89,39,49", "58,72,11,47,48,34,83,74,86,75,67,15,77,57,24", "38,23,62,94,51,58,72,25,11,47,55,48,34,83,74,86,13,53,91,59,75,67,84", "89,39,78,49,43,38,94,51,72,25,11,47,83,86,13", "55,34,86,13,53,91,59,75,67,84,15,77,79,57,24,71,98,19,45", "74,86,53,91,84,19,76", "71,98,19,45,85,97,17,39,64,27,43,62,51", "75,67,84,77,57,46,36,71,19,45,93,17,44,87,39", "11,55,34,74,13,53,91,59,84,77,57,71,98", "35,44,87,89,39,78,27,38,23,62,94,58,72,25,11,55,83", "94,51,72,55,34,86,13,53,91,67,15,77,79", "91,75,67,84,15,77,79,57,46,36,45,85,97,76,17,35,87", "79,57,46,24,71,98,45,85,97,76,17,44,87,89,39,64,49,27,43", "27,89,39,34,62,83,47,25,49,23,51,78,48,58,74,44,94,72,38", "85,97,93,76,17,35,44,87,23,58,11", "64,49,27,23,62,94,51,58,72,47,55,34,83,74,86,13,53,91,59", "78,64,49,27,43,38,23,62,94,51,58,72,25,47,55,48,34,83,74,86,13", "13,15,85,91,67,34,71,53,79,45,46,98,36,77,24,48,57,86,74,19,59,83,84", "49,27,23,51,58,55,34,74,86,53,75", "59,15,77,57,46,24,36,71,98,19,45,85,97,93,76,17,44,87,89", "23,89,76,39,36,38,43,98,85,44,46,17,35,93,71", "94,51,58,72,25,11,47,55,48,34,83,74,13,53,91,59,75,67,84,15,77,79,57", "55,64,58,89,39,86,23,72,38,13,48,25,47,34,27", "64,23,49,17,78,89,27,87,58,39,93,35,97,98,43,85,19,44,94", "87,85,19,72,58,38,64,17,43,49,93,39,76,23,97,51,78,94,44,62,35,27,89", "25,55,83,86,13,53,91,75,67,15,79,57,71", "49,43,23,62,94,58,72,25,47,55,48,83,75", "35,91,79,15,71,46,59,19,75,93,45,67,76,77,85,53,97,36,17,57,24,84,13").map { it.split(",").map { it.toInt() } }

data class Page(val num: Int, val dependencies: MutableList<Page> = mutableListOf())

val pages: Map<Int, Page> = updates.flatten().distinct().map { it to Page(it) }.toMap()

dependencies.forEach { (dependsOn, page) ->
    pages[page]?.dependencies?.add(pages[dependsOn]!!)
}

fun correctlyOrdered(pages: List<Page>): Boolean {
    if (pages.size <= 1) return true
    val head = pages[0]
    val tail = pages.drop(1)
    if (tail.any { head.dependencies.contains(it) }) {
        return false
    } else {
        return correctlyOrdered(tail)
    }
}

fun orderPages(pages: List<Page>): List<Page> {
    return pages.sortedWith(Comparator { page1, page2 -> if (page1.dependencies.contains(page2)) 1 else -1 })
}

val updatesPages: List<List<Page>> = updates.map { it.map { pageNum -> pages[pageNum]!! } }

val problem1Solution: Int = updatesPages
    .filter(::correctlyOrdered)
    .map { it[it.size / 2].num }
    .sum()
    .also(::println)

val problem2Solution: Int = updatesPages
    .filter { !correctlyOrdered(it) }
    .map(::orderPages)
    .map { it[it.size / 2].num }
    .sum()
    .also(::println)
